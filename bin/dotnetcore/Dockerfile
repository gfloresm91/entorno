# APP1 Stage
FROM microsoft/dotnet:2.1-aspnetcore-runtime AS base
ARG NETCORE_APP1_DIR_NAME
ARG NETCORE_APP1_DLL_NAME

# Transform to env var because arg dont work inside container
ENV NETCORE_APP1_DIR_NAME_ENV=$NETCORE_APP1_DIR_NAME
ENV NETCORE_APP1_DLL_NAME_ENV=$NETCORE_APP1_DLL_NAME

WORKDIR /source/$NETCORE_APP1_DIR_NAME_ENV

# I dont found a best form to this ;(
ENTRYPOINT ["sh", "-c", "dotnet $NETCORE_APP1_DLL_NAME_ENV"]

# APP2 stage example, same for others apps
# FROM base
# ARG NETCORE_APP2_DIR_NAME
# ARG NETCORE_APP2_DLL_NAME
# ENV NETCORE_APP2_DIR_NAME_ENV=$NETCORE_APP2_DIR_NAME
# ENV NETCORE_APP2_DLL_NAME_ENV=$NETCORE_APP2_DLL_NAME
# WORKDIR /source/$NETCORE_APP2_DIR_NAME_ENV
# ENTRYPOINT ["sh", "-c", "dotnet $NETCORE_APP2_DLL_NAME_ENV"]